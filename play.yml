---
- hosts: dev
  become: true
  tasks:
  - name: Install python pip
      yum:
        name: python-pip
        state: present
  - name: Install Docker
    yum:
      name: docker
      state: present
  - name: Start Docker Service
    service:
      name: docker
      state: started
      enabled: yes
  - name: Install docker-py python module
      pip:
        name: docker-py
        state: present
  - name: Provide execution permission to docker sock
    command: chmod 777 /var/run/docker.sock
  - name: Start container
    docker_container:
      name: demo
      image: "bijoyashis/demo:{DOCKER_TAG}"
      state: started
      published_ports:
          - 0.0.0.0:8080:8080
